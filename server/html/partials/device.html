<style type="text/css">
  #device {
    position: absolute;
    top: 20px;
    left: 40px;
    width: 300px;
    height: 597px;
  }
</style>
<iframe
  id="device"
  src="https://appetize.io/embed/{{app.publicKey}}?device={{device.model}}&amp;osVersion=5.1&amp;autoplay=true&amp;orientation={{device.orientation}}&amp;deviceColor=black&amp;xdocMsg=true&amp;params=%7b%22boop.server%22%3a%22{{encodeURIComponent server_url}}%22%2c%22boop.scripts%22%3A%22%5B%5C%22{{encodeURIComponent api_url}}%5C%22%5D%22%7D{{#device.location}}&amp;location={{.}}{{/device.location}}"
  frameborder="0"
  scrolling="no">
</iframe>

<script>
  // Heartbeat to prevent device timing out
  var device_iframe = document.getElementById('device');
  setInterval(function() {
    device_iframe.contentWindow.postMessage('heartbeat', '*');
  }, 15 * 1000);

  // Ensure the device is running
  setInterval(function() {
    device_iframe.contentWindow.postMessage('requestSession', '*');
  }, 5 * 1000);

  // Appetize.io logging
  window.addEventListener('message', function(event) {
    console.log('appetize.io: ' + event.data);
  });
</script>
