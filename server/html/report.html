<!DOCTYPE html>
<html>
  <head>
    <title>{{code.name}} report - {{result.app.name}} - boop.js</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="{{result.app.icon}}">

    {{> material-design}}

    <style type="text/css">
      .content {
        text-align: center;
      }

      #header {
        text-align: center;
        padding-top: 1em;
      }

      h2 .date {
        opacity: 0.5;
        margin-left: 0.5em;
        font-weight: 100;
      }

      h3 {
        margin: 0;
      }

      h3 a {
        color: inherit;
        margin-left: 1em;
        opacity: 0.67;
      }

      #report {
        text-align: left;
        list-style: none;
        padding: 0 1em;
        overflow-y: auto;
      }

      #report > li {
        white-space: nowrap;
        padding-bottom: 0.5em;
      }

      #report > li pre {
        display: inline-block;
        margin: 0;
      }

      #report > li .line-no {
        margin-right: 1em;
        color: #B6B6B6;
        width: 2em;
        display: inline-block;
        vertical-align: top;
        text-align: right;
        font-size: 0.8em;
        font-weight: 300;
      }

      #report > li.success .source {
        color: #43A047;
        vertical-align: top;
      }

      #report > li.error .source {
        color: #D32F2F;
      }

      #report > li > span:not(.line-no) {
        display: block;
        margin-left: 2.67em;
      }

      #report .line .line-no::after {
        margin: 0 1em;
        content: ' ';
      }
      #report .line.success .line-no::after {
        content: '\2713';
        color: #43A047;
      }
      #report .line.error .line-no::after {
        content: '\2717';
        color: #D32F2F;
      }

      div#error {
        padding: 2em 4em;
        background-color: #F44336;
        color: #FFCDD2;
      }

      div#error pre {
        text-align: left;
      }

      .result {
        padding-right: 0.5em;
        font-size: 1.5em;
      }

      .result .success {
        color: #4CAF50;
      }

      .result .failure {
        color: #F44336;
      }
    </style>
  </head>
  <body class="fullbleed">
    <paper-header-panel class="cyan">
      <div class="paper-header">
        <div class="right">
          {{> feedback-button}}
          {{> admin-button user}}
          {{> account-button user}}
        </div>
        <a href="/app/{{result.app.id}}/test/{{result.code_id}}/reports">
          <paper-icon-button icon="arrow-back"></paper-icon-button>
        </a>
        {{> app-info result.app}}
      </div>
      <div class="content">
        <div id="header">
          <h2 class="code {{#result.success}}success{{/result.success}} {{#result.error}}error{{/result.error}}">
            {{#result}}
              <span class="result">
                {{#success}}
                  <iron-icon icon="check" class="success" title="{{description}}"/>
                {{/success}}
                {{#error}}
                  <iron-icon icon="clear" class="failure" title="Test passed"/>
                {{/error}}
              </span>
            {{/result}}
            <a href="/app/{{result.app.id}}/test/{{result.code_id}}/edit" title="Edit {{code.name}}">{{code.name}}</a>
            <span class="date">{{date_relative result.started_at}}</span>
          </h2>
        </div>
        {{#result}}
          {{#error}}
            <div id="error" class="execution">
              <h3>
                {{description}}
                {{^description}}Unknown error{{/description}}
                {{#line}}
                  <a href="#line-{{.}}" class="line-no">Line {{.}}</a>
                {{/line}}
              </h3>
              {{#stacktrace}}
                <pre>{{.}}</pre>
              {{/stacktrace}}
            </div>
          {{/error}}
          <ol id="report" start="0">
            {{#report}}
              {{#.}}
                <li id="line-{{@index}}" class="line {{#success}} success{{/success}} {{#error}} error{{/error}}">
                  <span class="line-no">{{@index}}</span>
                  <pre class="source">{{source}}</pre>
                  {{#success}}
                    <span class="success"><pre>{{{stringify result}}}</pre></span>
                  {{/success}}
                  {{#error}}
                    <span class="error"><pre>{{description}}</pre></span>
                    <span class="stacktrace"><pre>{{stacktrace}}</pre></span>
                  {{/error}}
                  {{#unless success}}{{#unless error}}
                    <span>{{result}}</span>
                  {{/unless}}{{/unless}}
                </li>
              {{/.}}
            {{/report}}
          </ol>
        {{/result}}
      </div>
    </paper-header-panel>
  </body>

  {{> google-analytics}}

</html>
